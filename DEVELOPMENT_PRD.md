
# 📁 Pancrepal 小胰宝 - 开发需求文档 (V3.6)

## 1. 产品核心 Definition
*   **产品名称**：小胰宝 (Pancrepal)
*   **官方定义**：**肿瘤科普 | 病友/家属科普与病情主动管理伙伴**
*   **核心价值**：通过结构化的管理路线图、及时的 AI 科普回答、有温度的实时语音通话和互助社区，消除信息差，赋能病友主动管理病情。

## 2. 核心功能模块

### 2.1 智能 Management 路线图 (Roadmap)
- **详情页能力**：提供指南精要、附件资源（PDF/在线文档）及针对性 AI 提问入口。

### 2.2 知识大闯关 (Knowledge Quiz)
- **业务规则**：10 题一组，答对 1 题得 10 次 AI 配额。

### 2.3 小胰宝 AI 助手 (AI Copilot & Real-time Voice)
- **双模态交互**：支持文字聊天与实时语音通话（基于 Gemini Live API）。
- **实时语音 (Voice Mode)**：
    - **视觉规范**：超大圆形吉祥物头像（`w-44` 或更大），伴随多层半透明脉冲光环（呼吸灯效果）。
    - **播报状态**：吉祥物在说话时具有放大效果（`scale-110`）并伴随底部跳动的音频能量条。
    - **交互逻辑**：点击大头像可立即中断/停止当前播报。
    - **声音定制**：提供成年女性、成年男性、年轻男性三种音色切换。

### 2.4 互助社区 (Community)
- **奖励体系**：分享经验可赢取 AI 永久配额。

## 3. UI/UX 视觉与交互规范

### 3.1 首页 AI 入口增强
- **吉祥物交互**：聊天页首页的超大吉祥物图标不仅是装饰，**点击该图标必须能直接启动实时语音通话**。
- **引导提示**：吉祥物下方需配有“点击开启语音通话”的呼吸感标签。

### 3.2 免责声明区 (Disclaimer Area)
- **极致压缩高度**：位于底部导航栏上方，高度极小（`py-0.5`），无上边框，视觉上与导航栏融为一体。
- **单行展现**：文字缩写至极简一行，禁止折行，使用 `whitespace-nowrap`，确保在小屏幕下也只占一行空间。
- **文字规范**：颜色加深至 `text-slate-400`，字号 `text-[11px]`（关怀模式 `text-[13px]`），确保清晰可见。

### 3.3 适老关怀模式 (Care Mode)
- **全局缩放**：字体放大 1.15 倍。
- **关怀版语音**：语音助手页面的组件尺寸相应放大（头像从 `w-44` 增至 `w-52`）。

## 4. 技术规范 (Technical Path)
- **语音引擎**：利用 `@google/genai` 的 `live.connect` 接口，模型使用 `gemini-2.5-flash-native-audio-preview-09-2025`。
- **音频流处理**：使用原始 PCM 数据流（`audio/pcm;rate=16000`），需手动实现 Base64 编解码及 AudioContext 播放调度。
- **数据持久化**：用户配额、关怀模式状态存入 `localStorage`。

## 5. 核心样式代码参考 (Tailwind)
- **呼吸灯光环**：`bg-brand-core/10 rounded-full animate-pulse-subtle scale-110`
- **免责声明单行**：`text-slate-400 font-bold whitespace-nowrap overflow-hidden text-ellipsis`
- **吉祥物浮动**：内置 `mascot-float` 动画。

## 6. 免责声明固定文案
“⚠️ 声明：内容仅供科普参考，不作医疗建议，就医请遵医嘱。”
