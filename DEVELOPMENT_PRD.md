
# 📁 Pancrepal 小胰宝 - 开发需求文档 (V3.0)

## 1. 产品核心定义
*   **产品名称**：小胰宝 (Pancrepal)
*   **官方定义**：**肿瘤科普 | 病友/家属科普与病情主动管理伙伴**
*   **核心使命**：连接权威医学知识与病友真实经验，通过 AI 助手与路线图引导，帮助患者及家属实现科学、主动的病程管理。

## 2. 核心功能与交互规范

### 2.1 全局跳转逻辑 (Scroll Reset Policy) - 【高优先级】
*   **需求描述**：用户在应用内进行任何页面级跳转（如：切换底部 Tab、从路线图进入详情页、在详情页内点击推荐跳转）时，新页面必须从**顶部**开始显示。
*   **技术实现**：
    *   在 `App.tsx` 的 `main` 滚动容器中，通过 `useEffect` 监听 `activeTab` 和 `selectedStageId`。
    *   执行 `scrollTop = 0` 操作，确保切换瞬间重置。
    *   在 `StageDetailPage.tsx` 等内部含有滚动逻辑的组件中，同样需要监听 `id` 变化并重置内部 `scrollTop`。

### 2.2 智能工具系统 (Toolbox)
*   **清单维护**：必须包含以下 10 项核心工具：
    1. 医学百科 (KnowS)
    2. 诊疗指南 (CSCO)
    3. 腾讯医典
    4. 营养伴侣
    5. 心理守护
    6. 随访助手
    7. 疼痛日记
    8. 生活重建
    9. 名医直连
    10. 战友互助中心
*   **交互逻辑**：点击后显示 Loading 状态，模拟后端请求 URL Scheme 的过程。

### 2.3 AI 助手 (Pancrepal Copilot)
*   **角色设定**：基于 Gemini-3-Flash，定位为“病情主动管理伙伴”。
*   **回复限制**：严禁 Markdown，纯文本输出，结构化格式（【结论-标题】+ 解释），必须附带医疗免责声明。

### 2.4 内容分级与可信度
*   **标签体系**：使用 A/B/C 三级勋章展示信息来源。
    *   A：权威指南/卫健委
    *   B：三甲医院/专家署名
    *   C：平台审核/病友经验

## 3. 视觉规范 (Visual Identity)
*   **色调**：品牌绿 (#67CFA7)、活力橙 (#FF8A1F)。
*   **圆角**：统一使用超大圆角 (`rounded-3xl` 至 `rounded-5xl`)。
*   **动画**：全局吉祥物 (Mascot) 浮动动画，页面进入的淡入淡出动画。

## 4. 后续开发重点
1.  **品质生活入口优化**：确保从路线图进入“品质生活”详情页时，视觉焦点锁定在页面头部（Consensus 精要部分）。
2.  **数据埋点**：统计工具点击率与 AI 提问频率。
3.  **多阶段扩展**：完善路线图内其他 10+ 个阶段的内容填充。
